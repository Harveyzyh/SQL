SELECT TB001, RTRIM(TB002), TB003, CONVERT(FLOAT, TB004) - CONVERT(FLOAT, TB005) AS K FROM MOCTB
INNER JOIN MOCTA ON TA001 = TB001 AND TA002 = TB002
WHERE CONVERT(FLOAT, TB004) - CONVERT(FLOAT, TB005) < 0
AND SUBSTRING(MOCTB.CREATE_DATE, 1, 6) >= '201805801'
AND TA011 NOT IN ('Y', 'V', 'y')
ORDER BY TB002