SELECT TC003, TA006, MOCTA.UDF12, INVMB.UDF12, TE001, TE002, TE003, TE004, MOCTE.UDF03, MOCTE.UDF04, MW003
-- UPDATE MOCTE SET MOCTE.UDF03=ISNULL(CAST(MW003 AS VARCHAR(20)), '') 
-- UPDATE MOCTE SET MOCTE.UDF04=ISNULL(MOCTA.UDF12, '')
FROM MOCTE 
INNER JOIN MOCTC ON TC001 = TE001 AND TC002 = TE002
INNER JOIN MOCTA ON TE011 = TA001 AND TE012 = TA002 
INNER JOIN INVMB ON TA006 = MB001
INNER JOIN CMSMW ON MW001 = TE009 
WHERE 1=1
AND LEFT(TE001, 2) = '54'
-- AND MOCTE.UDF03 != CAST(MW003 AS VARCHAR(20)) 
AND MOCTE.UDF04 != MOCTA.UDF12
ORDER BY TC003, TE001, TE002, TE003


SELECT MOCTE.CREATE_DATE, TE001, TE002, TE003, MOCTE.UDF02, INVMB.UDF02
-- UPDATE MOCTE SET MOCTE.UDF02=INVMB.UDF02
FROM MOCTE 
INNER JOIN MOCTC ON TE001 = TC001 AND TE002 = TC002 
INNER JOIN INVMB ON MB001 = TE004 
WHERE MOCTE.UDF02 != INVMB.UDF02
AND LEFT(TE001, 2) = '54'
AND TC020 = ''
ORDER BY MOCTE.CREATE_DATE
