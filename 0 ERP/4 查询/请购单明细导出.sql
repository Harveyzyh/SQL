SELECT RTRIM(TA001) 请购单别, RTRIM(TA002) 请购单号, SUBSTRING(TA003, 1 , 4) + '-' + SUBSTRING(TA003, 5, 2) + '-' + SUBSTRING(TA003 ,7, 2) 请购日期, 
RTRIM(TA004) 请购部门编号, ISNULL(RTRIM(ME002), '') 请购部门名称, RTRIM(TA006) 单头备注, RTRIM(TA007) 单头审核码, 
RTRIM(TA012) 请购人员编号, ISNULL(RTRIM(MV002), '') 请购人员名称, RTRIM(TB003) 序号, RTRIM(TB004) 品号, RTRIM(TB005) 品名, RTRIM(TB006) 规格, 
RTRIM(TB007) 请购单位, RTRIM(TB008) 仓库, RTRIM(TB009) 请购数量, RTRIM(TB010) 参考供应商, ISNULL(MA002, '') 参考供应商名称, 
SUBSTRING(TB011, 1 , 4) + '-' + SUBSTRING(TB011, 5, 2) + '-' + SUBSTRING(TB011 ,7, 2) 需求日期, RTRIM(TB012) 请购备注, RTRIM(TB024) 采购备注, 
(CASE TB039 WHEN 'Y' THEN '自动结束' WHEN 'N' THEN '未结束' WHEN 'y' THEN '指定结束' END) 结束
FROM PURTA
INNER JOIN PURTB ON TA001 = TB001 AND TA002 = TB002
LEFT JOIN PURMA ON MA001 = TB010
LEFT JOIN CMSMV ON MV001 = TA012
LEFT JOIN CMSME ON ME001 = TA004
WHERE 1=1
AND TA001 = '3102'
AND TA002 = '19110058'