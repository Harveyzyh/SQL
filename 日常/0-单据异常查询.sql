USE COMFORT

--报废单
SELECT TL001 ,TL002, TM004, TL014, TM021 FROM INVTL 
LEFT JOIN INVTM ON TM001 = TL001 AND TM002 = TL002
WHERE TL014 <> TM021

--领料单
SELECT TC001 ,TC002, TE004, TC009, TE019 FROM MOCTC
LEFT JOIN MOCTE ON TC001 = TE001 AND TC002 = TE002
WHERE 1=1 
AND TC009 <> TE019
AND TC009 <> 'V'

--进货单
SELECT TG001, TG002, TH004, TG013, TH030 FROM PURTG
LEFT JOIN PURTH ON TH001 = TG001 AND TH002 = TG002
WHERE 1=1
AND TG013 <> TH030
AND SUBSTRING(PURTG.CREATE_DATE, 1, 6) > '201801'

--请购单
SELECT TA001, TA002, TB004, TA007, TB025  FROM PURTA 
LEFT JOIN PURTB ON TA001 = TB001 AND TA002 = TB002
WHERE 1=1
AND TA007 <> TB025
AND SUBSTRING(PURTA.CREATE_DATE, 1, 6) > '201801'



-------------------------------------
SELECT 
COPTD.TD001, COPTD.TD002, COPTD.TD003,
PURTB.TB001 请购单别, PURTB.TB002 请购单号, PURTB.TB003 请购单序号, PURTB.TB004 品号, INVMB.MB002 品名, PURTA.TA007 请购单头审核码, PURTB.TB025 请购单身审核码, 
PURTD.TD001 采购单别, PURTD.TD002 采购单号, PURTD.TD003 采购单序号, PURTC.TC014 采购单头审核码, PURTD.TD018 采购单身审核码
FROM COPTD

LEFT JOIN PURTB ON PURTB.TB029 = COPTD.TD001 AND PURTB.TB030 = COPTD.TD002 AND PURTB.TB031 = COPTD.TD003 
LEFT JOIN PURTA ON PURTA.TA001 = PURTB.TB001 AND PURTA.TA002 = PURTB.TB002
LEFT JOIN PURTD ON PURTD.TD026 = PURTB.TB001 AND PURTD.TD027 = PURTB.TB002 AND PURTD.TD028 = PURTB.TB003 
LEFT JOIN PURTC ON PURTC.TC001 = PURTD.TD001 AND PURTC.TC002 = PURTD.TD002
LEFT JOIN INVMB ON INVMB.MB001 = PURTB.TB004

WHERE 1=1
AND RTRIM(COPTD.TD001) + '-' + RTRIM(COPTD.TD002) + '-' + RTRIM(COPTD.TD003) = '2201-015138-0016'



---------------------------------------




SELECT 
COPTD.TD001, COPTD.TD002, COPTD.TD003,
MOCTA.TA006 成品品号, MOCTA.TA002 工单号, MOCTB.TB003 材料品号,
PURTB.TB001 请购单别, PURTB.TB002 请购单号, PURTB.TB003 请购单序号, PURTA.TA007 请购单头审核码, PURTB.TB025 请购单身审核码, 
PURTD.TD001 采购单别, PURTD.TD002 采购单号, PURTD.TD003 采购单序号, PURTC.TC014 采购单头审核码, PURTD.TD018 采购单身审核码
FROM COPTD

LEFT JOIN MOCTA ON MOCTA.TA026 = COPTD.TD001 AND MOCTA.TA027 = COPTD.TD002 AND MOCTA.TA028 = COPTD.TD003

LEFT JOIN MOCTB ON MOCTB.TB001 = MOCTA.TA001 AND MOCTB.TB002 = MOCTA.TA002
LEFT JOIN PURTB ON PURTB.TB029 = COPTD.TD001 AND PURTB.TB030 = COPTD.TD002 AND PURTB.TB031 = COPTD.TD003 --AND MOCTB.TB003 = PURTB.TB004
LEFT JOIN PURTA ON PURTA.TA001 = PURTB.TB001 AND PURTA.TA002 = PURTB.TB002
LEFT JOIN PURTD ON PURTD.TD026 = PURTB.TB001 AND PURTD.TD027 = PURTB.TB002 AND PURTD.TD028 = PURTB.TB003 
LEFT JOIN PURTC ON PURTC.TC001 = PURTD.TD001 AND PURTC.TC002 = PURTD.TD002

WHERE 1=1

--AND MOCTA.TA001 + '-' + MOCTA.TA002 = '5101-18070050'
AND RTRIM(COPTD.TD001) + '-' + RTRIM(COPTD.TD002) + '-' + RTRIM(COPTD.TD003) = '2201-015138-0016'


--AND MOCTA.TA013 <> 'V'
ORDER BY MOCTA.TA026, MOCTA.TA027, MOCTA.TA028, MOCTB.TB003