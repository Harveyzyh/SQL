---报价
DELETE FROM COPTA WHERE TA003<='20161231'

DELETE FROM COPTB WHERE TB001+TB002 NOT IN (SELECT TA001+TA002 FROM COPTA)

SELECT * FROM COPTA WHERE TA003<='20161231'

----订单

SELECT TD001+TD002+TD003 FROM COPTD 
LEFT JOIN COPTC ON TC001=TD001 AND TC002=TD002 
WHERE TC003<='20161231'  AND TD016<>'N' 

DELETE FROM COPTD WHERE TD001+TD002+TD003 IN 
(SELECT TD001+TD002+TD003 FROM COPTD 
LEFT JOIN COPTC ON TC001=TD001 AND TC002=TD002 
WHERE TC003<='20161231'  AND TD016<>'N')

DELETE FROM COPTC WHERE TC001+TC002 NOT IN (SELECT TD001+TD002 FROM COPTD)

--DELETE FROM COPTC WHERE TC003<='20131231'

--DELETE FROM COPTD WHERE TD001+TD002 NOT IN (SELECT TC001+TC002 FROM COPTC)

-------------------------------------------------------------------------------------------------------

---订单变更

SELECT * FROM COPTE WHERE TE001+TE002 NOT IN (SELECT TC001+TC002 FROM COPTC)

DELETE  FROM COPTE WHERE TE001+TE002 NOT IN (SELECT TC001+TC002 FROM COPTC)

DELETE FROM COPTF WHERE TF001+TF002 NOT IN (SELECT TE001+TE002 FROM COPTE)


--DELETE FROM COPTE WHERE TE004<='20141231'

--DELETE FROM COPTF WHERE TF001+TF002 NOT IN (SELECT TE001+TE002 FROM COPTE)

------------------------------------------------------------------------------------------------------------


---出货通知单

SELECT * FROM COPTO WHERE TO004+TO005+TO006 NOT IN (SELECT TD001+TD002+TD003 FROM COPTD)

DELETE FROM COPTO WHERE TO004+TO005+TO006 NOT IN (SELECT TD001+TD002+TD003 FROM COPTD)

DELETE FROM COPTN WHERE TN001+TN002 NOT IN (SELECT TO001+TO002 FROM COPTO)

--SELECT * FROM COPTN WHERE TN003<='20141231'

--DELETE FROM COPTN WHERE TN003<='20141231'

--DELETE FROM COPTO WHERE TO001+TO002 NOT IN (SELECT TN001+TN002 FROM COPTN)

-------------------------------------------------------------------------------------------

---销货单

SELECT TH001+TH002+TH003 FROM COPTH 
LEFT JOIN COPTG ON TG001=TH001 AND TG002=TH002 
WHERE TG003<='20161231'  AND TH014+TH015+TH016 NOT IN(SELECT TD001+TD002+TD003 FROM COPTD) AND TH026='Y'

DELETE FROM COPTH WHERE TH001+TH002+TH003 IN 
(SELECT TH001+TH002+TH003 FROM COPTH 
LEFT JOIN COPTG ON TG001=TH001 AND TG002=TH002 
WHERE TG003<='20161231'  AND (TH014+TH015+TH016 NOT IN(SELECT TD001+TD002+TD003 FROM COPTD) )) AND TH026='Y'

DELETE FROM COPTG WHERE TG001+TG002 NOT IN (SELECT TH001+TH002 FROM COPTH)


---------------------------------------------------------------------------------


---销退单

SELECT TJ001+TJ002+TJ003 FROM COPTJ 
LEFT JOIN COPTI ON TJ001=TI001 AND TJ002=TI002 
WHERE TI003<='20161231'  AND TJ018+TJ019+TJ020 NOT IN (SELECT TD001+TD002+TD003 FROM COPTD) AND TJ024='Y'

DELETE FROM COPTJ WHERE TJ001+TJ002+TJ003 IN 
(SELECT TJ001+TJ002+TJ003 FROM COPTJ 
LEFT JOIN COPTI ON TJ001=TI001 AND TJ002=TI002 
WHERE TI003<='20161231'  AND TJ018+TJ019+TJ020 NOT IN (SELECT TD001+TD002+TD003 FROM COPTD)) AND TJ024='Y'

DELETE FROM COPTI WHERE TI001+TI002 NOT IN (SELECT TJ001+TJ002 FROM COPTJ)


--------------------------------------------------------------------------------------------------------

--产品配置
SELECT * FROM   COPTQ  WHERE TQ006='V'  AND TQ007<='20161231'

DELETE COPTQ  FROM   COPTQ  WHERE TQ006='V'  AND TQ007<='20161231'

SELECT *FROM COPTR WHERE TR001+TR002 NOT IN (SELECT TQ001+TQ002 FROM COPTQ)  --AND  TR008='V'

DELETE COPTR FROM COPTR 
 WHERE TR001+TR002 NOT IN (SELECT TQ001+TQ002 FROM COPTQ)  
 
 
 -----------------------------------------------------------------------------------------------------------

---销售预测

SELECT * FROM COPME WHERE LEFT(CREATE_DATE,8)<='20161231'

DELETE FROM COPME WHERE LEFT(CREATE_DATE,8)<='20161231'

DELETE FROM COPMF WHERE MF001 NOT IN (SELECT ME001 FROM COPME)
