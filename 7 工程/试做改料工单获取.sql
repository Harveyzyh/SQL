SELECT (CASE TA011 WHEN '1' THEN '未生产' WHEN '2' THEN '已发料' WHEN '3' THEN '生产中' WHEN 'Y' THEN '已完工' END) AS TA011
, TA001, RTRIM(TA002) TA002, RTRIM(TA006) TA006, TA034, TA026, RTRIM(TA027) TA027, TA028 FROM MOCTA 
WHERE 1=1
AND TA026 + '-' + TA027 + '-' + TA028 IN (
'2205-066789     -0001',
'2205-066796     -0002',
'2205-066797     -0002',
'2205-066798     -0002',
'2205-066908     -0001',
'2205-066909     -0001',
'2205-066880     -0003',
'2205-066919     -0001'
)






-- 变更记录
SELECT TDD.RQ AS RQ, TDD.DD AS DD, TDD.DSL AS DSL, TA.TA011 AS TA011, TA.TA015 AS TA015, TB.TB002 AS TB002, 
TB.TB003 AS TB003, TB.TB006 AS TB006, TWL.YL AS YL, CONVERT(INT, TB.TB004) AS TB004, CONVERT(INT, TB.TB005) AS TB005, 
(CASE WHEN CL = '删除' THEN '0' ELSE CONVERT(INT, TDD.DSL) * CONVERT(INT, TWL.YL) END) SL, TWL.LX AS LX, TWL.CL AS CL 
FROM ATEST..T_DD AS TDD
INNER JOIN MOCTA AS TA ON RTRIM(TA.TA026) + '-' + RTRIM(TA.TA027) + '-' + RTRIM(TA.TA028) = TDD.DD
INNER JOIN MOCTB AS TB ON TB.TB001 = TA.TA001 AND TB.TB002 = TA.TA002
INNER JOIN ATEST..T_WL AS TWL ON TB.TB003 = TWL.WLNO AND TDD.DLX = TWL.LX
WHERE 1=1
AND TDD.Valid = 1
AND TDD.Check0 = 0
AND TA.TA015 = TDD.DSL
-- AND CONVERT(INT, TB004) != (CASE WHEN CL = '删除' THEN '0' ELSE CONVERT(INT, TDD.DSL) * CONVERT(INT, TWL.YL) END)
AND TDD.RQ >= 601
ORDER BY TDD.RQ, TDD.DD, TB.TB003


