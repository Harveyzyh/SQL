
DECLARE @TG001 VARCHAR(20), @TG002 VARCHAR(30), @PD_NO INT

SET @TG001 = '2301'
SET @TG002 = '19120001'
SET @PD_NO = 3

SELECT COPTH.TH003 AS 序号, RTRIM(COPTH.TH004) AS 品号, RTRIM(COPTH.TH005) AS 品名, RTRIM(COPTH.TH006) AS 规格,
RTRIM(COPTH.TH014) + '-' + RTRIM(COPTH.TH015) + '-' + RTRIM(COPTH.TH016) AS 生产单号, 
CONVERT(VARCHAR(10), CONVERT(FLOAT, COPTH.TH008)) AS 数量, RTRIM(COPTH.TH009) AS 单位, 
RTRIM(COPTH.UDF03) AS 描述备注, RTRIM(COPTH.UDF04) AS 保友品名, RTRIM(COPTH.UDF05) AS 配置方案, RTRIM(COPTH.UDF10) AS 产品电商代码, 
' ' + RTRIM(CMSMC.MC002) + CHAR(10)+ CHAR(10) + RTRIM(COPTH.TH004) AS 备注_身, RTRIM(COPTH.UDF01) AS PO号_身,

RTRIM(COPTG.TG001)+' '+RTRIM(COPTG.TG002) AS 出货单号, RTRIM(COPTG.UDF04) AS 拖车公司, RTRIM(COPTG.UDF03) AS 车牌, RTRIM(COPMA.MA002) AS 客户简称, 
RTRIM(SUBSTRING(COPTG.TG042,1,4)+'-'+SUBSTRING(COPTG.TG042,5,2)+'-'+SUBSTRING(COPTG.TG042,7,2)) AS 单据日期, RTRIM(COPTG.UDF05) AS 港口, RTRIM(COPTG.UDF06) AS PO号_头,
RTRIM(COPTG.UDF02) AS 柜型, RTRIM(COPTG.UDF01) AS 柜号, RTRIM(COPTG.UDF08) AS 原产地, RTRIM(CMSMV.MV002) AS 船务, RTRIM(COPTG.TG020) AS 备注_头, 
@PD_NO AS 栈板号 
FROM COPTH
INNER JOIN COPTG ON TG001 = TH001 AND TG002 = TH002
INNER JOIN COPMA ON COPMA.MA001 = COPTG.TG004 
INNER JOIN CMSMC ON COPTH.TH007 = CMSMC.MC001
INNER JOIN CMSMV ON COPTG.CREATOR = CMSMV.MV001 
WHERE RTRIM(TH001) =@TG001 AND RTRIM(TH002) = @TG002
ORDER BY COPTH.TH003



