-- 国内出货单
-- 电商出货单
DECLARE @TG001_S VARCHAR(20), @TG002_S VARCHAR(30)

-- SET @TG001_S = '2301'
-- SET @TG002_S = '18100020' 
SET @TG001_S = '2303'
SET @TG002_S = '19040415' 

SELECT COPTH.TH003 as No, RTRIM(COPTH.TH004) AS Wlno, RTRIM(COPTH.TH005) as LName, RTRIM(COPTH.UDF04) AS BName, RTRIM(COPTH.TH006) as Spec, RTRIM(COPTH.UDF02) as InId, 
CONVERT(VARCHAR(10), CONVERT(FLOAT, COPTH.TH008)) as Num, RTRIM(COPTH.TH009) as Unit, COPTH.UDF05 AS PeiZhi, 
COPTH.UDF03 as Describe, RTRIM(COPTH.UDF01) as PO_D, RTRIM(COPTH.UDF10) AS DianShangCode, 
RTRIM(COPTG.TG001)+' '+RTRIM(COPTG.TG002) AS OutId, RTRIM(COPTG.UDF04) AS TuoChe, RTRIM(COPTG.UDF03) AS ChePai, RTRIM(COPMA.MA002) AS KhJc, 
RTRIM(SUBSTRING(COPTG.TG042,1,4)+'-'+SUBSTRING(COPTG.TG042,5,2)+'-'+SUBSTRING(COPTG.TG042,7,2)) AS GDate, RTRIM(COPTC.TC035) AS GangKou, RTRIM(COPTG.UDF06) AS PO_T,
RTRIM(COPTG.UDF02) AS GuiXing, RTRIM(COPTG.UDF01) AS GuiHao, RTRIM(CMSMV.MV002) AS YeWu, RTRIM(COPTG.TG020) AS Remark_T 
FROM COPTH
INNER JOIN COPTG ON TG001 = TH001 AND TG002 = TH002
INNER JOIN COPMA ON COPMA.MA001 = COPTG.TG004 
INNER JOIN CMSMC ON COPTH.TH007 = CMSMC.MC001
INNER JOIN CMSMV ON COPTG.TG006 = CMSMV.MV001 
INNER JOIN COPTC ON COPTH.TH014 = COPTC.TC001 AND COPTH.TH015 = COPTC.TC002
WHERE RTRIM(TH001) = @TG001_S AND RTRIM(TH002) = @TG002_S

UNION
SELECT '9999' as No, CHAR(10) + '以下空白//' AS Wlno, '' as LName, '' AS BName, '' as Spec, '' as InId, 
'' as Num, '' as Unit, '' AS PeiZhi, 
'' as Describe, '' as PO_D, '' AS DianShangCode, 
'' AS OutId, '' AS TuoChe, '' AS ChePai, '' AS KhJc, 
'' AS GDate, '' AS GangKou, '' AS PO_T,
'' AS GuiXing, '' AS GuiHao, RTRIM(CMSMV.MV002) AS YeWu, RTRIM(COPTG.TG020) AS Remark_T 
FROM COPTH
INNER JOIN COPTG ON TG001 = TH001 AND TG002 = TH002
INNER JOIN COPMA ON COPMA.MA001 = COPTG.TG004 
INNER JOIN CMSMC ON COPTH.TH007 = CMSMC.MC001
INNER JOIN CMSMV ON COPTG.TG006 = CMSMV.MV001 
INNER JOIN COPTC ON COPTH.TH014 = COPTC.TC001 AND COPTH.TH015 = COPTC.TC002
WHERE RTRIM(TH001) = @TG001_S AND RTRIM(TH002) = @TG002_S
ORDER BY No