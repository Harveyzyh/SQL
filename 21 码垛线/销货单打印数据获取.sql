

-- 单身
SELECT COPTH.TH003 as No, RTRIM(COPTH.TH005) + CHAR(10) + COPTH.TH006 as NameSpec, COPTH.UDF02 as InId, 
' ' + LEFT(CONVERT(VARCHAR(10), CONVERT(FLOAT, COPTH.TH008)) + '        ', 8) + RTRIM(COPTH.TH009) as NumUnit, 
'' as ActNum, COPTH.UDF03 as Describe, ' ' + RTRIM(CMSMC.MC002) + CHAR(10) + RTRIM(COPTH.TH004) as Remark, RTRIM(COPTH.UDF01) as PO  
FROM COPTH
INNER JOIN CMSMC ON COPTH.TH007 = CMSMC.MC001
WHERE RTRIM(TH001) + '-' + RTRIM(TH002) = '2301-18100021'
union
SELECT '999999' AS No, '以下空白//' as NameSpec, '' AS InId, '' AS NumUnit, '' AS ActNum, '' AS Describe, '' AS Remark, '' AS PO   
ORDER BY No


-- 单头
SELECT RTRIM(COPTG.TG001)+' '+RTRIM(COPTG.TG002) AS OutId, RTRIM(COPTG.UDF04) AS TuoChe, RTRIM(COPTG.UDF03) AS ChePai, RTRIM(COPMA.MA002) AS KhJc, 
RTRIM(SUBSTRING(COPTG.TG042,1,4)+'-'+SUBSTRING(COPTG.TG042,5,2)+'-'+SUBSTRING(COPTG.TG042,7,2)) AS GDate, RTRIM(COPTG.UDF05) AS GangKou, RTRIM(COPTG.UDF06) AS PO,
RTRIM(COPTG.UDF02) AS GuiXing, RTRIM(COPTG.UDF01) AS GuiHao, RTRIM(COPTG.UDF08) AS YuanChanDi, RTRIM(CMSMV.MV002) AS ChuanWu 
FROM COPTG 
INNER JOIN COPMA ON COPMA.MA001 = COPTG.TG004 
INNER JOIN CMSMV ON COPTG.CREATOR = CMSMV.MV001 
WHERE RTRIM(COPTG.TG001) + '-' + RTRIM(COPTG.TG002) = '2301-18100021' 



SELECT 'AA' AS A