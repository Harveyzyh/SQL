
SELECT MB001 品号, MB002 品名, MB003 规格, SUM(TB004) 数量汇总, (CASE MOCTA.UDF04 WHEN '1' THEN '内销' ELSE '外销' END) 内外销 
FROM INVMB
INNER JOIN MOCTB ON TB003 = MB001
INNER JOIN MOCTA ON TA001 = TB001 AND TA002 = TB002 
WHERE 1=1
AND TA013 = 'Y'
AND SUBSTRING(MOCTB.CREATE_DATE, 1, 8) BETWEEN '20180101' AND '20181131'
AND MB001 IN ('3030101051'
, '3030101061', 
'3030101051', '3030101055', '3030101007', '3030101028', '3030101031', '3030101067', '3030101057', '3030101040', '3030101002', '3030101001', '3030101060', '3030101059',  
'3030101063', '3030101036', '3030101003', '3030101058', '3030101066', '3030101004', '3030101011', '3030101026', '3030101033', '3030101037', '3030101056', '3030101062') 

GROUP BY MB001, MB002, MB003, (CASE MOCTA.UDF04 WHEN '1' THEN '内销' ELSE '外销' END)
ORDER BY SUM(TB004) DESC, MB001