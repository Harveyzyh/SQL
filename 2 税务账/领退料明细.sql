SELECT TC003 单据日期, TC014 审核日期,  
(CASE WHEN TC001 LIKE '54%' THEN '领料' WHEN TC001 LIKE '56%' THEN '退料' WHEN TC001 LIKE '55%' THEN '委外发料' WHEN TC001 LIKE '57%' THEN '委外退料' ELSE TC001 END) 领退别, 
TC001 单别, TC002 单号, TE003 序号, TC009 单头审核码, TE019 单身审核码, 
TE004 品号, MB002 品名, MB003 规格, TE005 领退料数量, TE010 批号, MA002 供应商编号, TE011 工单别, TE012 工单号 
FROM MOCTC 
INNER JOIN MOCTE ON TE001=TC001 AND TE002 = TC002
INNER JOIN PURMA ON TE010 = MA001
LEFT JOIN INVMB ON TE004 = MB001
WHERE 1=1
AND TC014 BETWEEN '20190801' AND '20190831'

ORDER BY TC014, TC001, TC002, TE003



SELECT RTRIM(LA001) 品号, RTRIM(MB002) 品名, RTRIM(MB003) 规格, LA004 日期, LA006 单别, RTRIM(LA007) 单号, LA008 序号, RTRIM(LA009) 仓库, 
CONVERT(FLOAT, LA011) 单据交易库存数量, CONVERT(FLOAT, LA012) 单据单位成本, LA013 金额, LA017 金额材料, 
RTRIM(LA016) 批号, RTRIM(MA002) 供应商, RTRIM(LA024) 对象 
FROM INVLA
INNER JOIN INVMB ON MB001 = LA001
INNER JOIN PURMA ON MA001 = LA016
WHERE 1=1
AND LA004 BETWEEN '20190601' AND '20190631'
AND LA006 LIKE '5%'
ORDER BY LA004, LA006, LA007, LA008




-- 关联客户订单查询
SELECT RTRIM(LA001) 品号, RTRIM(MB002) 品名, RTRIM(MB003) 规格, LA004 日期, LA006 单别, RTRIM(LA007) 单号, LA008 序号, RTRIM(LA009) 仓库, 
CONVERT(FLOAT, LA011) 单据交易库存数量, CONVERT(FLOAT, LA012) 单据单位成本, LA013 金额, LA017 金额材料, 
RTRIM(LA016) 批号, RTRIM(PURMA.MA002) 供应商, RTRIM(LA024) 对象, 
RTRIM(TC001) + '-' + RTRIM(TC002) + '-' + RTRIM(TD003) 订单号, TC004 订单客户编号, COPMA.MA002 客户名称
FROM INVLA
INNER JOIN INVMB ON MB001 = LA001
INNER JOIN PURMA ON PURMA.MA001 = LA016
LEFT JOIN MOCTA ON RTRIM(TA001) + '-' + RTRIM(TA002) = LA024
LEFT JOIN COPTC ON TA026 = TC001 AND RTRIM(TA027) = RTRIM(TC002) 
LEFT JOIN COPTD ON TA026 = TD001 AND RTRIM(TA027) = RTRIM(TD002) AND TA028 = TD003
LEFT JOIN COPMA ON COPMA.MA001 = TC004
WHERE 1=1
AND LA004 BETWEEN '20190801' AND '20190831'
AND (LA006 LIKE '5%' OR LA006 LIKE '1%')

-- AND TC004 = '2336' -- 客户编号

ORDER BY LA004, LA006, LA007, LA008


