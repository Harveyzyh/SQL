SELECT TE001, TE002, TE003, TE004, TE005, TE009, TE012, TB004, TB004-TB005 WLL FROM MOCTE 
INNER JOIN MOCTB ON TE011 = TB001 AND TE012 = TB002 AND TE004 = TB003 AND TE009 = TB006
WHERE TE002 = '2019011162'
AND TB004>TE005



SELECT TE001, TE002, TE003, TE004, TE005, TE009, TE012 FROM MOCTE 
WHERE TE002 = '2019011242'
AND TE004 = '3030309020'
AND TE012 = '19010667'



SELECT TA001, TA002, TA011 FROM MOCTE
INNER JOIN MOCTB ON TE011 = TB001 AND TE012 = TB002 AND TE004 = TB003 AND TE009 = TB006
INNER JOIN MOCTA ON TA001 = TB001 AND TA002 = TB002
WHERE TE002 = '19011532'



SELECT * FROM MOCTD WHERE TD002 = '19013158'
SELECT * FROM MOCTD WHERE TD002 = '19010156'

SELECT *FROM MOCTC WHERE TC002 = '19013158'



--根据原领料单工单信息写入二次领料单中
INSERT INTO MOCTD (
COMPANY, CREATOR, USR_GROUP, CREATE_DATE, FLAG, TD001, TD002, TD003, TD004, TD005, TD006, 
TD007, TD008, TD009, TD010, TD011, TD012, TD013, TD014, TD015, TD016, TD017, TD018, TD019, 
TD020, TD021, TD022, TD023, TD024, TD025, TD026)

SELECT COMPANY, CREATOR, USR_GROUP, '20190115100000000', FLAG, TD001, '19013158', TD003, TD004, TD005, TD006, 
TD007, TD008, TD009, TD010, TD011, TD012, TD013, TD014, TD015, TD016, TD017, TD018, TD019, 
TD020, TD021, TD022, TD023, TD024, TD025, TD026
FROM MOCTD WHERE 1=1 
AND TD002 = '19011532'
AND TD004 != '18085030'

--更新单头来源
--UPDATE MOCTC SET TC019 = '5401', TC020 = '19011532' WHERE TC002 = '19013158'

SELECT TC001, TC002, UDF01 
--UPDATE MOCTC SET UDF01 = '15467' 
FROM MOCTC
WHERE TC002 IN ('19013158', '19013188', '19013418')

--更新单头单身创建人，日期，清空修改记录
SELECT MOCTD.CREATOR, MOCTD.CREATE_DATE, MOCTD.FLAG, MOCTC.CREATOR, MOCTC.CREATE_DATE, MOCTC.FLAG, MOCTE.CREATOR, MOCTE.CREATE_DATE, MOCTE.FLAG
--UPDATE MOCTC SET MOCTC.CREATOR = MOCTD.CREATOR, MOCTC.USR_GROUP = MOCTD.USR_GROUP, MOCTC.MODIFIER = NULL, MOCTC.MODI_DATE = NULL, MOCTC.FLAG = 1
--UPDATE MOCTE SET MOCTE.CREATOR = MOCTD.CREATOR, MOCTE.USR_GROUP = MOCTD.USR_GROUP, MOCTE.MODIFIER = NULL, MOCTE.MODI_DATE = NULL, MOCTE.FLAG = 1
--UPDATE MOCTD SET MOCTD.CREATE_DATE = MOCTC.CREATE_DATE
FROM MOCTC
INNER JOIN MOCTD ON TC001 = TD001 AND TC002 = TD002
INNER JOIN MOCTE ON TD001 = TE001 AND TD002 = TE002
AND TD002 = '19013158'